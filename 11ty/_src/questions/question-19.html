---
title: Question 19
layout: layouts/base.njk
tags: [question]
---

<div id="cell-id=3af02558-9cfb-4490-a614-18fa834b2f04" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Question-19">Question 19<a class="anchor-link" href="#Question-19">&#182;</a></h1><h4 id="What-would-be-the-fidelity-result(s)-for-these-two-operators,-which-differ-only-by-global-phase?">What would be the fidelity result(s) for these two operators, which differ only by global phase?<a class="anchor-link" href="#What-would-be-the-fidelity-result(s)-for-these-two-operators,-which-differ-only-by-global-phase?">&#182;</a></h4><pre><code>op_a = Operator(XGate())
op_b = numpy.exp(1j * 0.5) * Operator(XGate())
</code></pre>

</div>
</div>
</div>
<div id="cell-id=11423c8f-1a34-43f6-bec7-4988fa7d991b" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Answer-Options">Answer Options<a class="anchor-link" href="#Answer-Options">&#182;</a></h2><p><strong>A.</strong> <code>state_fidelity()</code> of 1.0<br />
<strong>B.</strong> <code>state_fidelity()</code> and <code>average_gate_fidelity()</code> of 1.0<br />
<strong>C.</strong> <code>average_gate_fidelity()</code> and <code>process_fidelity()</code> of 1.0<br />
<strong>D.</strong> <code>state_fidelity()</code>, <code>average_gate_fidelity()</code> and <code>process_fidelity()</code> of 1.0</p>

</div>
</div>
</div>
<div id="cell-id=b0100e8a-2b3d-4cd9-bb93-37de00af7ef6" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Question-Explanation">Question Explanation<a class="anchor-link" href="#Question-Explanation">&#182;</a></h2>
</div>
</div>
</div>
<div id="cell-id=e6ab0828-f175-4515-9f7d-43355fed38df" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This question focusses on fidelity, which is a measure of how close two quantum states are to each other.
State fidelity, measured by the <code>state_fidelity</code> function, measures the fidelity between two quantum states.
Process fidelity, measured by the <code>process_fidelity</code> function, measures the fidelity within a quantum channel or operator, and thus measures the noise within that channel or operator.
Average gate fidelity, measured by the <code>average_gate_fidelity</code> function, measures the fidelity of multiple gates within a quantum channel.</p>

</div>
</div>
</div>
<div id="cell-id=c9efafda-6d54-4abe-abd1-8f9ec59d4180" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References">&#182;</a></h2>
</div>
</div>
</div>
<div id="cell-id=5ab7aaa0-4744-4eda-80c2-9273b4a04900" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="https://qiskit.org/documentation/stubs/qiskit.quantum_info.state_fidelity.html">Qiskit state_fidelity() function API</a></li>
<li><a href="https://qiskit.org/documentation/stubs/qiskit.quantum_info.average_gate_fidelity.html">Qiskit average_gate_fidelity() function API</a></li>
<li><a href="https://qiskit.org/documentation/stubs/qiskit.quantum_info.average_gate_fidelity.html">Qiskit process_fidelity() function API</a></li>
</ul>

</div>
</div>
</div>
<div id="cell-id=5483029f-3803-4b75-a5e0-786ecfa15907" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Correct-Answer">Correct Answer<a class="anchor-link" href="#Correct-Answer">&#182;</a></h2>
</div>
</div>
</div>
<div id="cell-id=336be34a-1cbf-4256-bf29-fceefd8ef050" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>C.</strong> <code>average_gate_fidelity()</code> and <code>process_fidelity()</code> of 1.0</p>

</div>
</div>
</div>
<div id="cell-id=e2363f9b-5b8f-49f3-a090-f144e42b232a" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Answer-Explanation">Answer Explanation<a class="anchor-link" href="#Answer-Explanation">&#182;</a></h2>
</div>
</div>
</div>
<div id="cell-id=639939e7-90d6-4670-b338-d93b927d0820" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we begin by entering the given code to create the two operators themselves.</p>

</div>
</div>
</div>
<div id="cell-id=4e7587ff-bac2-4917-be91-b1ea0c492eb5" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Operator</span><span class="p">,</span> <span class="n">process_fidelity</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">XGate</span>

<span class="n">op_a</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">(</span><span class="n">XGate</span><span class="p">())</span>
<span class="n">op_b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Operator</span><span class="p">(</span><span class="n">XGate</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div id="cell-id=92deb54e-0aa4-486a-a330-4da9b2ff3863" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we look at the first operator <code>op_a</code>.</p>

</div>
</div>
</div>
<div id="cell-id=d0222355-6ef0-479d-8fca-90ddc7e1cb95" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.visualization</span> <span class="kn">import</span> <span class="n">array_to_latex</span>

<span class="n">array_to_latex</span><span class="p">(</span><span class="n">op_a</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;op_a: &quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
op_a: 
\begin{bmatrix}
0 &amp; 1  \\
 1 &amp; 0  \\
 \end{bmatrix}
$$
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=bb4cdd7c-6d19-4920-8417-c2dccfb7448d" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Followed by the second operator <code>op_b</code>.</p>

</div>
</div>
</div>
<div id="cell-id=7472b640-22bd-4df3-9ff9-6e2caee4a413" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array_to_latex</span><span class="p">(</span><span class="n">op_b</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;op_b: &quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
op_b: 
\begin{bmatrix}
0 &amp; 0.8775825619 + 0.4794255386 i  \\
 0.8775825619 + 0.4794255386 i &amp; 0  \\
 \end{bmatrix}
$$
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=4a990fd1-fdf2-4879-b26a-a491c4f8b6ac" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-state_fidelity()">1. <code>state_fidelity()</code><a class="anchor-link" href="#1.-state_fidelity()">&#182;</a></h3>
</div>
</div>
</div>
<div id="cell-id=c999d226-cb34-4a8c-bfaf-9cbc4b7db10b" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a trick question.
We cannot measure the state fidelity between the two operators, because they do not have states.
If we try to obtain the state fidelity, Qiskit will throw an error.</p>

</div>
</div>
</div>
<div id="cell-id=a8c3561a-ed07-439e-acb2-8f3e9793bcc4" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">state_fidelity</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">state_fidelity</span><span class="p">(</span><span class="n">op_a</span><span class="p">,</span> <span class="n">op_b</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception thrown: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exception thrown: &#39;Input is not a quantum state&#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div id="cell-id=1913a51e-e566-4c0b-bbd1-084b1ea6af6a" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even though we know we cannot obtain the state fidelity of the operators, just for fun we will obtain the state fidelity between two circuit that implement those operators.
However, it is important you first understand <code>state_vector</code> will not return a value, therefore it is undefined when it comes to answering the question.</p>
<p>To get a state fidelity, we created two <code>QuantumCircuit</code> objects and add the operators as <code>Instruction</code> objects.</p>

</div>
</div>
</div>
<div id="cell-id=623e93dc-5e88-4b91-81f0-95ed25ad13c8" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">BasicAer</span><span class="p">,</span> <span class="n">execute</span><span class="p">,</span> <span class="n">QuantumCircuit</span>

<span class="c1"># Build our circuits</span>
<span class="n">qc_a</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc_b</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Convert our operators to instructions</span>
<span class="n">inst_a</span> <span class="o">=</span> <span class="n">op_a</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
<span class="n">inst_b</span> <span class="o">=</span> <span class="n">op_b</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>

<span class="c1"># Add the instructions to the circuits</span>
<span class="n">qc_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst_a</span><span class="p">,</span> <span class="n">qargs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">qc_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst_b</span><span class="p">,</span> <span class="n">qargs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># obtains state vectors for each circuit</span>
<span class="n">state_a</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">qc_a</span><span class="p">,</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s2">&quot;statevector_simulator&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">qc_a</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">state_b</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">qc_b</span><span class="p">,</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s2">&quot;statevector_simulator&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">qc_b</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div id="cell-id=b8a10fd0-bbb6-4a46-a31c-e314d30daa42" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we can look at the state of the first circuit.</p>

</div>
</div>
</div>
<div id="cell-id=f382b4b7-bde3-43cd-8d40-79338b5dbbcd" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array_to_latex</span><span class="p">(</span><span class="n">state_a</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;|\Psi_</span><span class="si">{a}</span><span class="se">\\</span><span class="s2">rangle = &quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
|\Psi_{a}\rangle = 
\begin{bmatrix}
0 &amp; 1  \\
 \end{bmatrix}
$$
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=6cc0cb7a-ad25-47a3-a05c-9e04a768913f" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can look at the state of the second circuit.</p>

</div>
</div>
</div>
<div id="cell-id=24a6d6c2-6a39-4af3-b832-27fe741ad0a0" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array_to_latex</span><span class="p">(</span><span class="n">state_b</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;|\Psi_</span><span class="si">{b}</span><span class="se">\\</span><span class="s2">rangle = &quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
|\Psi_{b}\rangle = 
\begin{bmatrix}
0 &amp; 0.8775825619 + 0.4794255386 i  \\
 \end{bmatrix}
$$
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=eda483b0-2041-4c7d-afab-a5975178cc23" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can obtain the <code>state_fidelity</code> between the states of these two circuits.
However, remember once again that there is no state fidelity between operators.</p>

</div>
</div>
</div>
<div id="cell-id=6c885e01-8465-49f0-8c8c-18f186ddbad2" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state_fidelity</span><span class="p">(</span><span class="n">state_a</span><span class="p">,</span> <span class="n">state_b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=5805284e-0072-424e-b9d8-bf913d05a433" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-average_gate_fidelity()">2. <code>average_gate_fidelity()</code><a class="anchor-link" href="#2.-average_gate_fidelity()">&#182;</a></h3>
</div>
</div>
</div>
<div id="cell-id=6f7b743b-77dd-4407-b613-694d9876199d" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To obtain the average gate fidelity between the two operators, we can just pass the two operators as parameters to the <code>average_gate_fidelity</code> function.</p>

</div>
</div>
</div>
<div id="cell-id=4ffd7e24-7868-4246-a758-906b37f9fead" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">average_gate_fidelity</span>

<span class="n">average_gate_fidelity</span><span class="p">(</span><span class="n">op_a</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">op_b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=01952a20-8398-4461-82b2-6e23f1fecea8" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see above, the <code>average_gate_fidelity</code> is 1.</p>

</div>
</div>
</div>
<div id="cell-id=32c46e6f-ce8d-4a13-8716-199d8e839200" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-process_fidelity()">3. <code>process_fidelity()</code><a class="anchor-link" href="#3.-process_fidelity()">&#182;</a></h3>
</div>
</div>
</div>
<div id="cell-id=4944390b-c3cd-4b3f-9fd0-f5e3ba491c51" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To obtain the process fidelity between the two operators, we can just pass the two operators as parameters to the <code>process_fidelity</code> function.</p>

</div>
</div>
</div>
<div id="cell-id=6160fa6d-57a6-48d6-ad4b-8f95cd5f640d" class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">process_fidelity</span>

<span class="n">process_fidelity</span><span class="p">(</span><span class="n">op_a</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">op_b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
<div id="cell-id=0ca02692-8812-49fb-85dd-bfe2d0e56a41" class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see above, the <code>process_fidelity</code> is 1.</p>

</div>
</div>
</div>


